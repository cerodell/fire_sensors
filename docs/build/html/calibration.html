
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Performance</title>
    
  <link rel="stylesheet" href="_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.c441f2ba0852f4cabcb80105e3a46ae6.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    
  <link rel="preload" as="script" href="_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Code" href="code.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/ubc_pm_logo.png" class="logo" alt="logo">
  
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <p class="caption collapsible-parent">
 <span class="caption-text">
  Contents:
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="pmbuild.html">
   The Sensor
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="code.html">
   Code
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Performance
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#first-open-another-dataset-and-merge-with-the-one-we-have-been-using">
   First, open another dataset and merge with the one we have been using.
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/calibration.ipynb.txt"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i>
            Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Performance
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#import-opc-data">
     Import OPC data!
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-pm-1-0">
       Plot PM 1.0
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-pm-2-5">
       Plot PM 2.5
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-pm-10">
       Plot PM 10
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#preliminary-results">
     Preliminary Results
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-time-series-pm-1-0-2-5-and-10-from-the-grimm-sensor">
       Plot time series PM 1.0, 2.5 and 10 from the GRIMM sensor.
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-counts-of-particle-sizes-averaged-over-time">
       Plot counts of particle sizes averaged over time.
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calibration">
     Calibration
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#correct-pm-2-5-with-an-linear-regrestion">
       Correct PM 2.5 with an linear regrestion.
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#first-open-another-dataset-and-merge-with-the-one-we-have-been-using">
   First, open another dataset and merge with the one we have been using.
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#correct-pm-2-5-with-an-mlp">
     Correct PM 2.5 with an MLP
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <section id="performance">
<h1>Performance<a class="headerlink" href="#performance" title="Permalink to this headline">¶</a></h1>
<p>We compared our low-cost UBC - PM sensors to an industry-standard GRIMM OPC sensor (Model: 1.109). For the comparison, saltwater solutions with known molar concentrations were fed into an atomizer. The atomizer separated/produced air-borne salt particles that traveled through an adjustable filter and into a 22L glass chamber containing the five UBC – PM Sensors and a small fan to mix the air (Figure 4CR). Simultaneously, the Grimm OPC sensor pulled air from the glass chamber to sample particle concentrations. The chamber also had an exhaust port to help maintain consistent concentration levels.
<br>
<br>
<img src="_static/img/chamber.jpeg" alt="chamber" width="300"/>
<br>
<br></p>
<p>The primary objective was to compare the UBC - PM Sensor’s static and dynamic response to the GRIMM instrument. To accomplish this, adjustments to the inflow filter were made to moderate the concentrations of particles entering the chamber. An appropriate amount of time was given so that the concentration levels stabilize. Sampling time ranged between 15-30 minutes. Concentration values were varied so that a calibration curve could be derived and then applied to the UBC – PM sensors to correlate to the GRIMM measured values. In developing the calibration cure it was assumed that the GRIMM OPC provided a true measure of PM concentrations.
<br>
<br>
We conducted 16.5 hours of sampling over a two-day period. The GRIMM and UBC – PM sensors sample at one minute and 1.6 seconds, respectively. The UBC - PM sensors were time-averaged to the same one-minute sampling period of the GRIMM instrument for comparison. Of the five UBC – PM sensors, one malfunctioned and reported erroneous values and was removed from the study.
<br>
<br>
Lets Dive in and assess the the first 12 hours of sampling data (obtained on day one).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">context</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">reduce</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.dates</span> <span class="kn">import</span> <span class="n">DateFormatter</span>
<span class="kn">from</span> <span class="nn">matplotlib.offsetbox</span> <span class="kn">import</span> <span class="n">AnchoredText</span>
<span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="k">as</span> <span class="nn">pylab</span>
<span class="kn">import</span> <span class="nn">sklearn</span>
<span class="kn">from</span> <span class="nn">sklearn.neural_network</span> <span class="kn">import</span> <span class="n">MLPRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>

<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">context</span> <span class="kn">import</span> <span class="n">data_dir</span><span class="p">,</span> <span class="n">save_dir</span>

<span class="c1"># Back pratices but this keeps the notebook clean when displaying on html</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>******************************
context imported. Front of path:
/Users/rodell/Documents/Arduino
/Users/rodell/Documents/Arduino/docs/source
******************************

through /Users/rodell/Documents/Arduino/docs/source/context.py -- pha
</pre></div>
</div>
</div>
</div>
<section id="import-opc-data">
<h2>Import OPC data!<a class="headerlink" href="#import-opc-data" title="Permalink to this headline">¶</a></h2>
<p>UBC AQ data was one minute averaged to match the GRIMM sample rate.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## define date of interest</span>
<span class="n">date_of_int</span> <span class="o">=</span> <span class="s1">&#39;20210430&#39;</span> <span class="c1"># options 20210430 or 20210502</span>


<span class="k">def</span> <span class="nf">prepare_df</span><span class="p">(</span><span class="n">ubc_pm</span><span class="p">,</span> <span class="n">date_of_int</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Function cleans UBC OPCs data by removing duplicate headers and dropping error values. </span>
<span class="sd">  Once cleaned takes 1 min avg of data to match GRIM sample rate.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span> <span class="o">+</span> <span class="n">ubc_pm</span> <span class="o">+</span> <span class="n">date_of_int</span> <span class="o">+</span> <span class="s1">&#39;.TXT&#39;</span><span class="p">)</span>
  <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">rtctime</span> <span class="o">==</span> <span class="s1">&#39;rtctime&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
  <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="o">~</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;pm10_env&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;Rec&#39;</span><span class="p">)]</span>
  <span class="n">time</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;rtctime&#39;</span><span class="p">])</span>
  <span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;rtctime&#39;</span><span class="p">]))</span>
  <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;rtctime&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
  <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;pm10_env&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">4000</span><span class="p">]</span>
  <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;pm25_env&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">4000</span><span class="p">]</span>
  <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;pm100_env&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">4000</span><span class="p">]</span>

  <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;1Min&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

  <span class="n">col</span> <span class="o">=</span> <span class="n">ubc_pm</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
  <span class="n">new_name</span> <span class="o">=</span> <span class="p">{}</span>
  <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">new_name</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">name</span> <span class="p">:</span> <span class="n">col</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">name</span><span class="p">}</span> <span class="p">)</span>
  <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">new_name</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<p>Open the ubc opcs</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ubc_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">prepare_df</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;/UBC-PM-0</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">/&quot;</span><span class="p">,</span> <span class="n">date_of_int</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)]</span>
<span class="n">df_ubc</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;rtctime&#39;</span><span class="p">),</span> <span class="n">ubc_list</span><span class="p">)</span>
<span class="n">df_ubc</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df_ubc</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_y&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Open the grim opc</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">open_grimm</span><span class="p">(</span><span class="n">date_of_int</span><span class="p">,</span> <span class="n">min_ubc</span><span class="p">):</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="n">df_grim</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span> <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;/GRIM/</span><span class="si">{</span><span class="n">date_of_int</span><span class="si">}</span><span class="s1">.csv&#39;</span><span class="p">)</span>
    <span class="n">df_grim</span><span class="p">[</span><span class="s1">&#39;date &amp; time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_grim</span><span class="p">[</span><span class="s1">&#39;date &amp; time&#39;</span><span class="p">])</span>
  <span class="k">except</span><span class="p">:</span>
    <span class="n">pathlist</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/2021_OPCintercomparison/&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">date_of_int</span><span class="si">}</span><span class="s1">*&#39;</span><span class="p">))</span>
    <span class="n">sheets</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PM values&#39;</span><span class="p">,</span> <span class="s1">&#39;Count values&#39;</span><span class="p">,</span> <span class="s1">&#39;Mass values&#39;</span><span class="p">,</span> <span class="s1">&#39;Log values&#39;</span><span class="p">]</span>
    <span class="n">df_grim</span> <span class="o">=</span> <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pathlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">pathlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s1">_sample01.xlsx&#39;</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span> <span class="n">sheet</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;openpyxl&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">sheet</span> <span class="ow">in</span> <span class="n">sheets</span><span class="p">]</span>
    <span class="n">df_grim</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;date &amp; time&#39;</span><span class="p">),</span> <span class="n">df_grim</span><span class="p">)</span>
    <span class="n">df_grim</span><span class="p">[</span><span class="s1">&#39;date &amp; time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_grim</span><span class="p">[</span><span class="s1">&#39;date &amp; time&#39;</span><span class="p">],</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">df_grim</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span> <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;/GRIM/</span><span class="si">{</span><span class="n">date_of_int</span><span class="si">}</span><span class="s1">.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>


  <span class="n">df_grim</span><span class="p">[</span><span class="s1">&#39;date &amp; time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_grim</span><span class="p">[</span><span class="s1">&#39;date &amp; time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="s1">&#39;1min&#39;</span><span class="p">)</span>  
  <span class="n">df_grim</span> <span class="o">=</span> <span class="n">df_grim</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;date &amp; time&#39;</span><span class="p">)</span>
  <span class="n">df_grim</span> <span class="o">=</span> <span class="n">df_grim</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">min_ubc</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>
  <span class="n">df_grim</span> <span class="o">=</span> <span class="n">df_grim</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
  <span class="k">return</span> <span class="n">df_grim</span>

<span class="n">min_ubc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">ubc_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ubc_list</span><span class="p">))])</span>
<span class="n">df_grim</span> <span class="o">=</span> <span class="n">open_grimm</span><span class="p">(</span><span class="n">date_of_int</span><span class="p">,</span> <span class="n">ubc_list</span><span class="p">[</span><span class="n">min_ubc</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Merge UBC dfs with Grimm df and print first five rows</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="n">df_grim</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">df_ubc</span><span class="p">,</span> <span class="n">left_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">df_final</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df_final</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_y&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">df_final</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PM10 [ug/m3]</th>
      <th>PM2.5 [ug/m3]</th>
      <th>PM1 [ug/m3]</th>
      <th>Inhalable [ug/m3]</th>
      <th>Thoracic [ug/m3]</th>
      <th>Alveolic [ug/m3]</th>
      <th>0.25 um_x</th>
      <th>0.28 um_x</th>
      <th>0.30 um_x</th>
      <th>0.35 um_x</th>
      <th>...</th>
      <th>UBC_PM_05_pm25_standard</th>
      <th>UBC_PM_05_pm100_standard</th>
      <th>UBC_PM_05_particles_03um</th>
      <th>UBC_PM_05_particles_05um</th>
      <th>UBC_PM_05_particles_10um</th>
      <th>UBC_PM_05_particles_25um</th>
      <th>UBC_PM_05_particles_50um</th>
      <th>UBC_PM_05_particles_100um</th>
      <th>UBC_PM_05_TX_batvolt</th>
      <th>UBC_PM_05_RX_batvolt</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2021-04-30 09:27:00</th>
      <td>18.8</td>
      <td>18.8</td>
      <td>18.7</td>
      <td>18.8</td>
      <td>18.8</td>
      <td>18.8</td>
      <td>257654.0</td>
      <td>104605.0</td>
      <td>23570.0</td>
      <td>7505.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>209.750000</td>
      <td>58.125000</td>
      <td>9.250000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4.320208</td>
      <td>4.274375</td>
    </tr>
    <tr>
      <th>2021-04-30 09:28:00</th>
      <td>19.1</td>
      <td>19.1</td>
      <td>19.0</td>
      <td>19.1</td>
      <td>19.1</td>
      <td>19.1</td>
      <td>267314.0</td>
      <td>107470.0</td>
      <td>23815.0</td>
      <td>7135.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>159.319149</td>
      <td>43.531915</td>
      <td>5.234043</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4.320000</td>
      <td>4.272766</td>
    </tr>
    <tr>
      <th>2021-04-30 09:29:00</th>
      <td>19.6</td>
      <td>19.6</td>
      <td>19.5</td>
      <td>19.6</td>
      <td>19.6</td>
      <td>19.6</td>
      <td>278557.0</td>
      <td>110995.0</td>
      <td>23810.0</td>
      <td>7395.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>191.361702</td>
      <td>56.936170</td>
      <td>4.978723</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4.320426</td>
      <td>4.275745</td>
    </tr>
    <tr>
      <th>2021-04-30 09:30:00</th>
      <td>19.6</td>
      <td>19.6</td>
      <td>19.5</td>
      <td>19.6</td>
      <td>19.6</td>
      <td>19.6</td>
      <td>285831.0</td>
      <td>111255.0</td>
      <td>23620.0</td>
      <td>7360.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>162.255319</td>
      <td>48.255319</td>
      <td>7.234043</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4.320213</td>
      <td>4.274255</td>
    </tr>
    <tr>
      <th>2021-04-30 09:31:00</th>
      <td>20.0</td>
      <td>20.0</td>
      <td>20.0</td>
      <td>20.0</td>
      <td>20.0</td>
      <td>20.0</td>
      <td>298343.0</td>
      <td>115235.0</td>
      <td>23745.0</td>
      <td>7190.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>231.319149</td>
      <td>60.893617</td>
      <td>8.510638</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4.320426</td>
      <td>4.274468</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 176 columns</p>
</div></div></div>
</div>
<p>Define default font sizes for ploting</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
         <span class="s1">&#39;xtick.labelsize&#39;</span><span class="p">:</span><span class="mi">14</span><span class="p">,</span>
         <span class="s1">&#39;ytick.labelsize&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span>
          <span class="s1">&#39;axes.labelsize&#39;</span><span class="p">:</span><span class="mi">14</span><span class="p">,</span>

         <span class="p">}</span>

<span class="n">pylab</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="plot-pm-1-0">
<h3>Plot PM 1.0<a class="headerlink" href="#plot-pm-1-0" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">colors</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.prop_cycle&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">by_key</span><span class="p">()[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span>


<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">autofmt_xdate</span><span class="p">()</span>
<span class="n">xfmt</span> <span class="o">=</span> <span class="n">DateFormatter</span><span class="p">(</span><span class="s2">&quot;%m-</span><span class="si">%d</span><span class="s2"> %H:00&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;PM 1.0 ($\frac{\mu g}{m^3}$)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_final</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;PM1 [ug/m3]&#39;</span><span class="p">],</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">4.0</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;GRIMM&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_final</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;UBC_PM_01_pm10_env&#39;</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;UBC-PM-01&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="c1"># ax.plot(df_final.index,df_final[&#39;UBC_PM_02_pm10_env&#39;], label = &#39;UBC-PM-02&#39;, color = colors[2])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_final</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;UBC_PM_03_pm10_env&#39;</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;UBC-PM-03&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_final</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;UBC_PM_04_pm10_env&#39;</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;UBC-PM-04&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_final</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;UBC_PM_05_pm10_env&#39;</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;UBC-PM-05&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\frac{\mu g}{m^3}$&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (MM-DD HH)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
    <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper center&quot;</span><span class="p">,</span>
    <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.44</span><span class="p">),</span>
    <span class="n">ncol</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
    <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;PM1 [ug/m3]&#39;</span><span class="p">],</span> <span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;PM1 [ug/m3]&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;PM1 [ug/m3]&#39;</span><span class="p">],</span> <span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;UBC_PM_01_pm10_env&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="c1"># ax.scatter(df_grim[&#39;PM1 [ug/m3]&#39;], df_final[&#39;UBC_PM_02_pm10_env&#39;], s=size, color = colors[2])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;PM1 [ug/m3]&#39;</span><span class="p">],</span> <span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;UBC_PM_03_pm10_env&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;PM1 [ug/m3]&#39;</span><span class="p">],</span> <span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;UBC_PM_04_pm10_env&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;PM1 [ug/m3]&#39;</span><span class="p">],</span> <span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;UBC_PM_05_pm10_env&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\frac{\mu g}{m^3}$&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\frac{\mu g}{m^3}$&#39;</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">bins</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.6</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;PM1 [ug/m3]&#39;</span><span class="p">],</span><span class="n">bins</span><span class="p">,</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;UBC_PM_01_pm10_env&#39;</span><span class="p">],</span><span class="n">bins</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="c1"># ax.hist(df_final[&#39;UBC_PM_02_pm10_env&#39;],bins, alpha = alpha,color = colors[2])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;UBC_PM_03_pm10_env&#39;</span><span class="p">],</span><span class="n">bins</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;UBC_PM_04_pm10_env&#39;</span><span class="p">],</span><span class="n">bins</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;UBC_PM_05_pm10_env&#39;</span><span class="p">],</span><span class="n">bins</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\frac{\mu g}{m^3}$&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;$\\frac{\\mu g}{m^3}$&#39;)
</pre></div>
</div>
<img alt="_images/calibration_14_1.png" src="_images/calibration_14_1.png" />
</div>
</div>
<p>Figure 1; scatter plots, histograms, and a times series comparison of the measured PM 1.0 concentration of four UBC- PM Sensors [UBC-PM-01 (orange), UBC-PM-03 (green), UBC-PM-04 (red), UBC-PM-05 (purple)] and the GRIM sensor [GRIMM (blue)]. The time series shows one-minute averaged PM 1.0 concentrations incremented from 2021-04-30 09:27:00 until 2021-04-30 21:36:00</p>
</section>
<section id="plot-pm-2-5">
<h3>Plot PM 2.5<a class="headerlink" href="#plot-pm-2-5" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">autofmt_xdate</span><span class="p">()</span>
<span class="n">xfmt</span> <span class="o">=</span> <span class="n">DateFormatter</span><span class="p">(</span><span class="s2">&quot;%m-</span><span class="si">%d</span><span class="s2"> %H:00&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;PM 2.5 ($\frac{\mu g}{m^3}$)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_final</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;PM2.5 [ug/m3]&#39;</span><span class="p">],</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">4.0</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;GRIMM&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_final</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;UBC_PM_01_pm25_env&#39;</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;UBC-PM-01&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="c1"># ax.plot(df_final.index,df_final[&#39;UBC_PM_02_pm10_env&#39;], label = &#39;UBC-PM-02&#39;, color = colors[2])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_final</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;UBC_PM_03_pm25_env&#39;</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;UBC-PM-03&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_final</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;UBC_PM_04_pm25_env&#39;</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;UBC-PM-04&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_final</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;UBC_PM_05_pm25_env&#39;</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;UBC-PM-05&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\frac{\mu g}{m^3}$&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (MM-DD HH)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
    <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper center&quot;</span><span class="p">,</span>
    <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.44</span><span class="p">),</span>
    <span class="n">ncol</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
    <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;PM2.5 [ug/m3]&#39;</span><span class="p">],</span> <span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;PM2.5 [ug/m3]&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;PM2.5 [ug/m3]&#39;</span><span class="p">],</span> <span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;UBC_PM_01_pm25_env&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="c1"># ax.scatter(df_grim[&#39;PM2.5 [ug/m3]&#39;], df_final[&#39;UBC_PM_02_pm25_env&#39;], s=size, color = colors[2])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;PM2.5 [ug/m3]&#39;</span><span class="p">],</span> <span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;UBC_PM_03_pm25_env&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;PM2.5 [ug/m3]&#39;</span><span class="p">],</span> <span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;UBC_PM_04_pm25_env&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;PM2.5 [ug/m3]&#39;</span><span class="p">],</span> <span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;UBC_PM_05_pm25_env&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\frac{\mu g}{m^3}$&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\frac{\mu g}{m^3}$&#39;</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">bins</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.6</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;PM2.5 [ug/m3]&#39;</span><span class="p">],</span><span class="n">bins</span><span class="p">,</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;UBC_PM_01_pm25_env&#39;</span><span class="p">],</span><span class="n">bins</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="c1"># ax.hist(df_final[&#39;UBC_PM_02_pm25_env&#39;],bins, alpha = alpha,color = colors[2])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;UBC_PM_03_pm25_env&#39;</span><span class="p">],</span><span class="n">bins</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;UBC_PM_04_pm25_env&#39;</span><span class="p">],</span><span class="n">bins</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;UBC_PM_05_pm25_env&#39;</span><span class="p">],</span><span class="n">bins</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\frac{\mu g}{m^3}$&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;$\\frac{\\mu g}{m^3}$&#39;)
</pre></div>
</div>
<img alt="_images/calibration_17_1.png" src="_images/calibration_17_1.png" />
</div>
</div>
<p>Figure 2; scatter plots, histograms, and a times series comparison of the measured PM 2.5 concentration of four UBC- PM Sensors [UBC-PM-01 (orange), UBC-PM-03 (green), UBC-PM-04 (red), UBC-PM-05 (purple)] and the GRIM sensor [GRIMM (blue)]. The time series shows one-minute averaged PM 2.5 concentrations incremented from 2021-04-30 09:27:00 until 2021-04-30 21:36:00</p>
</section>
<section id="plot-pm-10">
<h3>Plot PM 10<a class="headerlink" href="#plot-pm-10" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">autofmt_xdate</span><span class="p">()</span>
<span class="n">xfmt</span> <span class="o">=</span> <span class="n">DateFormatter</span><span class="p">(</span><span class="s2">&quot;%m-</span><span class="si">%d</span><span class="s2"> %H:00&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;PM 10 ($\frac{\mu g}{m^3}$)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_final</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;PM10 [ug/m3]&#39;</span><span class="p">],</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">4.0</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;GRIMM&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_final</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;UBC_PM_01_pm100_env&#39;</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;UBC-PM-01&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="c1"># ax.plot(df_final.index,df_final[&#39;UBC_PM_02_pm100_env&#39;], label = &#39;UBC-PM-02&#39;, color = colors[2])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_final</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;UBC_PM_03_pm100_env&#39;</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;UBC-PM-03&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_final</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;UBC_PM_04_pm100_env&#39;</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;UBC-PM-04&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_final</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;UBC_PM_05_pm100_env&#39;</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;UBC-PM-05&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\frac{\mu g}{m^3}$&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (MM-DD HH)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
    <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper center&quot;</span><span class="p">,</span>
    <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.44</span><span class="p">),</span>
    <span class="n">ncol</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
    <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;PM10 [ug/m3]&#39;</span><span class="p">],</span> <span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;PM10 [ug/m3]&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;PM10 [ug/m3]&#39;</span><span class="p">],</span> <span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;UBC_PM_01_pm100_env&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="c1"># ax.scatter(df_grim[&#39;PM10 [ug/m3]&#39;], df_final[&#39;UBC_PM_02_pm100_env&#39;], s=size, color = colors[2])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;PM10 [ug/m3]&#39;</span><span class="p">],</span> <span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;UBC_PM_03_pm100_env&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;PM10 [ug/m3]&#39;</span><span class="p">],</span> <span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;UBC_PM_04_pm100_env&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;PM10 [ug/m3]&#39;</span><span class="p">],</span> <span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;UBC_PM_05_pm100_env&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\frac{\mu g}{m^3}$&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\frac{\mu g}{m^3}$&#39;</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">bins</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.6</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;PM10 [ug/m3]&#39;</span><span class="p">],</span><span class="n">bins</span><span class="p">,</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;UBC_PM_01_pm100_env&#39;</span><span class="p">],</span><span class="n">bins</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="c1"># ax.hist(df_final[&#39;UBC_PM_02_pm10_env&#39;],bins, alpha = alpha,color = colors[2])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;UBC_PM_03_pm100_env&#39;</span><span class="p">],</span><span class="n">bins</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;UBC_PM_04_pm100_env&#39;</span><span class="p">],</span><span class="n">bins</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;UBC_PM_05_pm100_env&#39;</span><span class="p">],</span><span class="n">bins</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\frac{\mu g}{m^3}$&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;$\\frac{\\mu g}{m^3}$&#39;)
</pre></div>
</div>
<img alt="_images/calibration_20_1.png" src="_images/calibration_20_1.png" />
</div>
</div>
<p>Figure 3; scatter plots, histograms, and a times series comparison of the measured PM 10 concentration of four UBC- PM Sensors [UBC-PM-01 (orange), UBC-PM-03 (green), UBC-PM-04 (red), UBC-PM-05 (purple)] and the GRIM sensor [GRIMM (blue)]. The time series shows one-minute averaged PM 10 concentrations incremented from 2021-04-30 09:27:00 until 2021-04-30 21:36:00</p>
</section>
</section>
<section id="preliminary-results">
<h2>Preliminary Results<a class="headerlink" href="#preliminary-results" title="Permalink to this headline">¶</a></h2>
<p>Based upon the above graphics the UBC- PM sensors perform acceptably at PM 1.0 concentrations; however, they significantly over-predict the concentration levels of PM 2.5 and 10.
<br>
To understand why this occurred let’s looked at a time series of the GRIMM PM 1.0, 2.5 and 10 and the particle size distribution.</p>
<section id="plot-time-series-pm-1-0-2-5-and-10-from-the-grimm-sensor">
<h3>Plot time series PM 1.0, 2.5 and 10 from the GRIMM sensor.<a class="headerlink" href="#plot-time-series-pm-1-0-2-5-and-10-from-the-grimm-sensor" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">autofmt_xdate</span><span class="p">()</span>
<span class="n">xfmt</span> <span class="o">=</span> <span class="n">DateFormatter</span><span class="p">(</span><span class="s2">&quot;%m-</span><span class="si">%d</span><span class="s2"> %H:00&quot;</span><span class="p">)</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.7</span>

<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;GRIMM PM [1, 2.5, 10] ($\frac{\mu g}{m^3}$)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_final</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;PM1 [ug/m3]&#39;</span><span class="p">],</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">4.0</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;PM1&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_final</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;PM2.5 [ug/m3]&#39;</span><span class="p">],</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">4.0</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;PM2.5&#39;</span><span class="p">,</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_final</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;PM10 [ug/m3]&#39;</span><span class="p">],</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">4.0</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;PM10&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\frac{\mu g}{m^3}$&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (MM-DD HH)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
    <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper center&quot;</span><span class="p">,</span>
    <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.44</span><span class="p">),</span>
    <span class="n">ncol</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
    <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;PM1 [ug/m3]&#39;</span><span class="p">],</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;PM1 [ug/m3]&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;PM2.5 [ug/m3]&#39;</span><span class="p">],</span> <span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;PM2.5 [ug/m3]&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="n">size</span><span class="p">,</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;PM10 [ug/m3]&#39;</span><span class="p">],</span> <span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;PM10 [ug/m3]&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\frac{\mu g}{m^3}$&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\frac{\mu g}{m^3}$&#39;</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">bins</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;PM1 [ug/m3]&#39;</span><span class="p">],</span><span class="n">bins</span><span class="p">,</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;PM2.5 [ug/m3]&#39;</span><span class="p">],</span><span class="n">bins</span><span class="p">,</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;PM10 [ug/m3]&#39;</span><span class="p">],</span><span class="n">bins</span><span class="p">,</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\frac{\mu g}{m^3}$&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;$\\frac{\\mu g}{m^3}$&#39;)
</pre></div>
</div>
<img alt="_images/calibration_24_1.png" src="_images/calibration_24_1.png" />
</div>
</div>
<p>Figure 4: A time series of the  GRIMM sensor PM [1, 2.5, 10] incremented from 2021-04-30 09:27:00 until 2021-04-30 21:36:00.</p>
</section>
<section id="plot-counts-of-particle-sizes-averaged-over-time">
<h3>Plot counts of particle sizes averaged over time.<a class="headerlink" href="#plot-counts-of-particle-sizes-averaged-over-time" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_final</span><span class="p">)[</span><span class="mi">6</span><span class="p">:</span><span class="mi">37</span><span class="p">]</span>
<span class="n">var_labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">var_list</span><span class="p">]</span>
<span class="n">df_final_mean</span> <span class="o">=</span> <span class="n">df_final</span><span class="p">[</span><span class="n">var_list</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Time averaged counts/liter of particles of size XX um&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">var_labels</span><span class="p">,</span><span class="n">df_final_mean</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Counts/liter&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Particles of size XX um&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">var_labels</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Text(0, 0, &#39;0.25 um&#39;),
 Text(1, 0, &#39;0.28 um&#39;),
 Text(2, 0, &#39;0.30 um&#39;),
 Text(3, 0, &#39;0.35 um&#39;),
 Text(4, 0, &#39;0.40 um&#39;),
 Text(5, 0, &#39;0.45 um&#39;),
 Text(6, 0, &#39;0.50 um&#39;),
 Text(7, 0, &#39;0.58 um&#39;),
 Text(8, 0, &#39;0.65 um&#39;),
 Text(9, 0, &#39;0.70 um&#39;),
 Text(10, 0, &#39;0.80 um&#39;),
 Text(11, 0, &#39;1.00 um&#39;),
 Text(12, 0, &#39;1.30 um&#39;),
 Text(13, 0, &#39;1.60 um&#39;),
 Text(14, 0, &#39;2.00 um&#39;),
 Text(15, 0, &#39;2.50 um&#39;),
 Text(16, 0, &#39;3.00 um&#39;),
 Text(17, 0, &#39;3.50 um&#39;),
 Text(18, 0, &#39;4.00 um&#39;),
 Text(19, 0, &#39;5.00 um&#39;),
 Text(20, 0, &#39;6.50 um&#39;),
 Text(21, 0, &#39;7.50 um&#39;),
 Text(22, 0, &#39;8.50 um&#39;),
 Text(23, 0, &#39;10.00 um&#39;),
 Text(24, 0, &#39;12.50 um&#39;),
 Text(25, 0, &#39;15.00 um&#39;),
 Text(26, 0, &#39;17.50 um&#39;),
 Text(27, 0, &#39;20.00 um&#39;),
 Text(28, 0, &#39;25.00 um&#39;),
 Text(29, 0, &#39;30.00 um&#39;),
 Text(30, 0, &#39;32.00 um&#39;)]
</pre></div>
</div>
<img alt="_images/calibration_27_1.png" src="_images/calibration_27_1.png" />
</div>
</div>
<p>Figure 5 Time-averaged counts/liter of particles of size XX um, as measured by the GRIMM sensor.
<br>
<br></p>
<p>As depicted above all air-borne salt particles are 0.7 um or lower, with the majority at 0.3 um, implying that no deviation in PM concentration for PM 1.0, 2.5, and 10 values should exist. Comparing the GRIMM measured PM [1.0, 2.5, 10] supports this consideration.
<br>
<br>
Based upon the above it is believed that our UBC-PM sensors aren’t sensitive enough to delineate clusters of small particles from larger particles. As a result, higher concentration values in PM 2.5 and 10 are indicated. More work needs to be done to support this statement.</p>
</section>
</section>
<section id="calibration">
<h2>Calibration<a class="headerlink" href="#calibration" title="Permalink to this headline">¶</a></h2>
<p>We will construct a multilayer perceptron (MLP) model to try and correct our UBC-Pm sensor inaccuracy. We will test our UBC-PM-03 sensors using measured PM2.5 and particle counts at 03um, 05um, 10um 25um 50um, and 100um as input in the MLP. The MLP target will be the GRIMM PM2.5</p>
<section id="correct-pm-2-5-with-an-linear-regrestion">
<h3>Correct PM 2.5 with an linear regrestion.<a class="headerlink" href="#correct-pm-2-5-with-an-linear-regrestion" title="Permalink to this headline">¶</a></h3>
</section>
</section>
</section>
<section id="first-open-another-dataset-and-merge-with-the-one-we-have-been-using">
<h1>First, open another dataset and merge with the one we have been using.<a class="headerlink" href="#first-open-another-dataset-and-merge-with-the-one-we-have-been-using" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># open all ubc_pm datafiles into a list</span>
<span class="n">ubc_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">prepare_df</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;/UBC-PM-0</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">/&quot;</span><span class="p">,</span> <span class="s1">&#39;20210502&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)]</span>
<span class="c1">## combine them to one dataframe</span>
<span class="n">df_ubc</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;rtctime&#39;</span><span class="p">),</span> <span class="n">ubc_list</span><span class="p">)</span>
<span class="c1">## drop odd character header added when combining</span>
<span class="n">df_ubc</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df_ubc</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_y&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="c1">## find the ubc dataframe with the lowest time stapms</span>
<span class="n">min_ubc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">ubc_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ubc_list</span><span class="p">))])</span>
<span class="c1">## open the GRIMM dataset and restrict time to smallest ubc pm timeseries</span>
<span class="n">df_grim</span> <span class="o">=</span> <span class="n">open_grimm</span><span class="p">(</span><span class="s1">&#39;20210502&#39;</span><span class="p">,</span> <span class="n">ubc_list</span><span class="p">[</span><span class="n">min_ubc</span><span class="p">])</span>
<span class="c1">## combine all the ubc pm dataframes with the grimm dataframe</span>
<span class="n">df_final2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="n">df_grim</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">df_ubc</span><span class="p">,</span> <span class="n">left_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="c1">## drop odd character header added when combining</span>
<span class="n">df_final2</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df_final2</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_y&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="c1">## drop the last 30 mins for this datafile as the sensors were removed form the glass chamber but still sampling</span>
<span class="n">df_final2</span> <span class="o">=</span> <span class="n">df_final2</span><span class="p">[:</span><span class="s1">&#39;2021-05-02T18:50&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<section id="correct-pm-2-5-with-an-mlp">
<h2>Correct PM 2.5 with an MLP<a class="headerlink" href="#correct-pm-2-5-with-an-mlp" title="Permalink to this headline">¶</a></h2>
<p>First, subset dataframe and normalize</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pm</span> <span class="o">=</span> <span class="s1">&#39;2.5&#39;</span> 
<span class="n">pm_u</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="c1"># pm = pm[0]</span>
<span class="n">ubc_pm</span> <span class="o">=</span> <span class="s1">&#39;UBC_PM_03_pm&#39;</span>
<span class="n">keep_vars</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;PM</span><span class="si">{</span><span class="n">pm</span><span class="si">}</span><span class="s1"> [ug/m3]&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ubc_pm</span><span class="si">}{</span><span class="n">pm_u</span><span class="si">}</span><span class="s1">_env&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ubc_pm</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s1">_particles_03um&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ubc_pm</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s1">_particles_05um&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ubc_pm</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s1">_particles_10um&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ubc_pm</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s1">_particles_25um&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ubc_pm</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s1">_particles_50um&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ubc_pm</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s1">_particles_100um&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df_final</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df_final</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">keep_vars</span><span class="p">])</span>
<span class="c1"># df[f&#39;{ubc_pm}{pm_u}_env2&#39;] = df[f&#39;{ubc_pm}{pm_u}_env&#39;]</span>
<span class="n">df</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PM2.5 [ug/m3]</th>
      <th>UBC_PM_03_pm25_env</th>
      <th>UBC_PM_03_particles_03um</th>
      <th>UBC_PM_03_particles_05um</th>
      <th>UBC_PM_03_particles_10um</th>
      <th>UBC_PM_03_particles_25um</th>
      <th>UBC_PM_03_particles_50um</th>
      <th>UBC_PM_03_particles_100um</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2021-04-30 21:28:00</th>
      <td>82.3</td>
      <td>123.391304</td>
      <td>20559.913043</td>
      <td>6086.869565</td>
      <td>1308.282609</td>
      <td>57.782609</td>
      <td>5.173913</td>
      <td>4.521739</td>
    </tr>
    <tr>
      <th>2021-04-30 21:29:00</th>
      <td>81.3</td>
      <td>117.155556</td>
      <td>20010.400000</td>
      <td>5856.111111</td>
      <td>1248.311111</td>
      <td>64.200000</td>
      <td>8.800000</td>
      <td>5.155556</td>
    </tr>
    <tr>
      <th>2021-04-30 21:30:00</th>
      <td>80.7</td>
      <td>119.413043</td>
      <td>19804.500000</td>
      <td>5807.152174</td>
      <td>1254.195652</td>
      <td>73.739130</td>
      <td>7.565217</td>
      <td>4.173913</td>
    </tr>
    <tr>
      <th>2021-04-30 21:31:00</th>
      <td>79.7</td>
      <td>116.304348</td>
      <td>19685.413043</td>
      <td>5788.217391</td>
      <td>1227.217391</td>
      <td>59.282609</td>
      <td>8.086957</td>
      <td>6.434783</td>
    </tr>
    <tr>
      <th>2021-04-30 21:32:00</th>
      <td>78.1</td>
      <td>114.217391</td>
      <td>19493.543478</td>
      <td>5707.108696</td>
      <td>1207.956522</td>
      <td>66.260870</td>
      <td>11.000000</td>
      <td>8.043478</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Normalize data and print</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># split up data</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">scaled</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">scaled</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:]</span>

<span class="k">try</span><span class="p">:</span>
  <span class="c1"># load mlp</span>
  <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span><span class="o">+</span><span class="sa">f</span><span class="s1">&#39;/mlps/</span><span class="si">{</span><span class="n">ubc_pm</span><span class="si">}{</span><span class="n">pm_u</span><span class="si">}</span><span class="s1">.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fid</span><span class="p">:</span>
      <span class="n">model</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fid</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;found mpl for </span><span class="si">{</span><span class="n">ubc_pm</span><span class="si">}{</span><span class="n">pm_u</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;can not find mpl for </span><span class="si">{</span><span class="n">ubc_pm</span><span class="si">}{</span><span class="n">pm_u</span><span class="si">}</span><span class="s1">, building...&#39;</span><span class="p">)</span>
  <span class="n">nhn</span> <span class="o">=</span> <span class="mi">8</span> 
  <span class="n">hidden_layers</span> <span class="o">=</span> <span class="mi">2</span>
  <span class="n">model</span> <span class="o">=</span> <span class="n">MLPRegressor</span><span class="p">(</span>
      <span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">(</span><span class="n">nhn</span><span class="p">,</span> <span class="n">hidden_layers</span><span class="p">),</span>
      <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
      <span class="n">max_iter</span><span class="o">=</span><span class="mi">1500</span><span class="p">,</span>
      <span class="n">early_stopping</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
      <span class="n">validation_fraction</span><span class="o">=</span><span class="mf">0.2</span> <span class="p">,</span>
      <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
      <span class="n">solver</span><span class="o">=</span><span class="s2">&quot;adam&quot;</span> <span class="p">,</span>
      <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span>
      <span class="n">learning_rate_init</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span>
  <span class="p">)</span>

  <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>  <span class="c1"># train the model</span>
  <span class="c1"># save the mlp</span>
  <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span><span class="o">+</span><span class="sa">f</span><span class="s1">&#39;/mlps/</span><span class="si">{</span><span class="n">ubc_pm</span><span class="si">}{</span><span class="n">pm_u</span><span class="si">}</span><span class="s1">.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fid</span><span class="p">:</span>
      <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">fid</span><span class="p">)</span>    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>found mpl for UBC_PM_03_pm25
</pre></div>
</div>
</div>
</div>
<p>Open a dataset from another days comparisons of the GRIMM v UBC-PMs</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># open all ubc_pm datafiles into a list</span>
<span class="n">ubc_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">prepare_df</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;/UBC-PM-0</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">/&quot;</span><span class="p">,</span> <span class="s1">&#39;20210502&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)]</span>
<span class="c1">## combine them to one dataframe</span>
<span class="n">df_ubc</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;rtctime&#39;</span><span class="p">),</span> <span class="n">ubc_list</span><span class="p">)</span>
<span class="c1">## drop odd character header added when combining</span>
<span class="n">df_ubc</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df_ubc</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_y&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="c1">## find the ubc dataframe with the lowest time stapms</span>
<span class="n">min_ubc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">ubc_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ubc_list</span><span class="p">))])</span>
<span class="c1">## open the GRIMM dataset and restrict time to smallest ubc pm timeseries</span>
<span class="n">df_grim</span> <span class="o">=</span> <span class="n">open_grimm</span><span class="p">(</span><span class="s1">&#39;20210502&#39;</span><span class="p">,</span> <span class="n">ubc_list</span><span class="p">[</span><span class="n">min_ubc</span><span class="p">])</span>
<span class="c1">## combine all the ubc pm dataframes with the grimm dataframe</span>
<span class="n">df_final2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="n">df_grim</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">df_ubc</span><span class="p">,</span> <span class="n">left_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="c1">## drop odd character header added when combining</span>
<span class="n">df_final2</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df_final2</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_y&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="c1">## drop the last 30 mins for this datafile as the sensors were removed form the glass chamber but still sampling</span>
<span class="n">df_final2</span> <span class="o">=</span> <span class="n">df_final2</span><span class="p">[:</span><span class="s1">&#39;2021-05-02T18:50&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>reduce dataframe to be only a few variable of interest..print last 5 rows</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># keep_vars = [f&#39;PM{pm} [ug/m3]&#39;, f&#39;{ubc_pm}{pm_u}_env&#39;]</span>
<span class="n">keep_vars</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;PM</span><span class="si">{</span><span class="n">pm</span><span class="si">}</span><span class="s1"> [ug/m3]&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ubc_pm</span><span class="si">}{</span><span class="n">pm_u</span><span class="si">}</span><span class="s1">_env&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ubc_pm</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s1">_particles_03um&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ubc_pm</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s1">_particles_05um&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ubc_pm</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s1">_particles_10um&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ubc_pm</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s1">_particles_25um&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ubc_pm</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s1">_particles_50um&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ubc_pm</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s1">_particles_100um&#39;</span><span class="p">]</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df_final2</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df_final2</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">keep_vars</span><span class="p">])</span>
<span class="c1"># df2[f&#39;{ubc_pm}{pm_u}_env2&#39;] = df2[f&#39;{ubc_pm}{pm_u}_env&#39;]</span>
<span class="n">df2</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PM2.5 [ug/m3]</th>
      <th>UBC_PM_03_pm25_env</th>
      <th>UBC_PM_03_particles_03um</th>
      <th>UBC_PM_03_particles_05um</th>
      <th>UBC_PM_03_particles_10um</th>
      <th>UBC_PM_03_particles_25um</th>
      <th>UBC_PM_03_particles_50um</th>
      <th>UBC_PM_03_particles_100um</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2021-05-02 18:46:00</th>
      <td>139.1</td>
      <td>260.733333</td>
      <td>43740.866667</td>
      <td>12995.000000</td>
      <td>2722.688889</td>
      <td>103.222222</td>
      <td>16.177778</td>
      <td>10.444444</td>
    </tr>
    <tr>
      <th>2021-05-02 18:47:00</th>
      <td>142.2</td>
      <td>260.217391</td>
      <td>43413.652174</td>
      <td>12950.217391</td>
      <td>2667.173913</td>
      <td>113.000000</td>
      <td>19.826087</td>
      <td>15.304348</td>
    </tr>
    <tr>
      <th>2021-05-02 18:48:00</th>
      <td>124.6</td>
      <td>239.066667</td>
      <td>40453.000000</td>
      <td>11988.222222</td>
      <td>2443.888889</td>
      <td>106.000000</td>
      <td>11.555556</td>
      <td>10.711111</td>
    </tr>
    <tr>
      <th>2021-05-02 18:49:00</th>
      <td>108.3</td>
      <td>192.511111</td>
      <td>33387.400000</td>
      <td>9880.066667</td>
      <td>1933.800000</td>
      <td>56.044444</td>
      <td>6.444444</td>
      <td>3.511111</td>
    </tr>
    <tr>
      <th>2021-05-02 18:50:00</th>
      <td>105.5</td>
      <td>182.413043</td>
      <td>32692.891304</td>
      <td>9600.586957</td>
      <td>1645.673913</td>
      <td>74.021739</td>
      <td>8.608696</td>
      <td>5.869565</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Normalize this reduce dataframe and use our mlp model to correct to grimm</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scaler2</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">scaled2</span> <span class="o">=</span> <span class="n">scaler2</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>

<span class="c1"># split up data</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">scaled2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">scaled2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:]</span>
<span class="n">y_predict</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
    <span class="n">x2</span>
<span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
<p>Inverse transform or “unnormalize” data</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_predict</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">y_predict</span><span class="p">,</span><span class="n">x2</span><span class="p">))</span>
<span class="n">unscaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_predict</span><span class="p">)</span>
<span class="n">df_final2</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ubc_pm</span><span class="si">}{</span><span class="n">pm_u</span><span class="si">}</span><span class="s1">_cor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">unscaled</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Plot corrected UBC PM 2.5</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r2value_cor</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span>
    <span class="n">stats</span><span class="o">.</span><span class="n">pearsonr</span><span class="p">(</span><span class="n">df_final2</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;PM</span><span class="si">{</span><span class="n">pm</span><span class="si">}</span><span class="s1"> [ug/m3]&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">df_final2</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ubc_pm</span><span class="si">}{</span><span class="n">pm_u</span><span class="si">}</span><span class="s1">_cor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span>
<span class="p">)</span>
<span class="n">r2value</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span>
    <span class="n">stats</span><span class="o">.</span><span class="n">pearsonr</span><span class="p">(</span><span class="n">df_final2</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;PM</span><span class="si">{</span><span class="n">pm</span><span class="si">}</span><span class="s1"> [ug/m3]&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">df_final2</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ubc_pm</span><span class="si">}{</span><span class="n">pm_u</span><span class="si">}</span><span class="s1">_env&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span>
<span class="p">)</span>
<span class="n">rmse_cor</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span>
    <span class="nb">round</span><span class="p">(</span>
        <span class="n">mean_squared_error</span><span class="p">(</span>
            <span class="n">df_final2</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;PM</span><span class="si">{</span><span class="n">pm</span><span class="si">}</span><span class="s1"> [ug/m3]&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">df_final2</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ubc_pm</span><span class="si">}{</span><span class="n">pm_u</span><span class="si">}</span><span class="s1">_cor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">),</span>
        <span class="mi">2</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="n">rmse</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span>
    <span class="nb">round</span><span class="p">(</span>
        <span class="n">mean_squared_error</span><span class="p">(</span>
            <span class="n">df_final2</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;PM</span><span class="si">{</span><span class="n">pm</span><span class="si">}</span><span class="s1"> [ug/m3]&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">df_final2</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ubc_pm</span><span class="si">}{</span><span class="n">pm_u</span><span class="si">}</span><span class="s1">_env&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">),</span>
        <span class="mi">2</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="n">anchored_text</span> <span class="o">=</span> <span class="n">AnchoredText</span><span class="p">(</span>
    <span class="s2">&quot;UBC-PM-03:        &quot;</span> <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;$r$ &quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">r2value</span><span class="si">}</span><span class="s2"> rmse: </span><span class="si">{</span><span class="n">rmse</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot; </span><span class="se">\n</span><span class="s2">UBC-PM-03 Cor:  &quot;</span> <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;$r$ &quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">r2value_cor</span><span class="si">}</span><span class="s2"> rmse: </span><span class="si">{</span><span class="n">rmse_cor</span><span class="si">}</span><span class="s2">&quot;</span>  <span class="p">,</span>
    <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span>
    <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="s2">&quot;zorder&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>
<span class="p">)</span>


<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">autofmt_xdate</span><span class="p">()</span>
<span class="n">xfmt</span> <span class="o">=</span> <span class="n">DateFormatter</span><span class="p">(</span><span class="s2">&quot;%m-</span><span class="si">%d</span><span class="s2"> %H:00&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;PM 2.5 ($\frac{\mu g}{m^3}$)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_final2</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">df_final2</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;PM</span><span class="si">{</span><span class="n">pm</span><span class="si">}</span><span class="s1"> [ug/m3]&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">4.0</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;GRIMM&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_final2</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">df_final2</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ubc_pm</span><span class="si">}{</span><span class="n">pm_u</span><span class="si">}</span><span class="s1">_cor&#39;</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;UBC-PM-03 Corrected&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_final2</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">df_final2</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ubc_pm</span><span class="si">}{</span><span class="n">pm_u</span><span class="si">}</span><span class="s1">_env&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;UBC-PM-03&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\frac{\mu g}{m^3}$&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (MM-DD HH)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
    <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper center&quot;</span><span class="p">,</span>
    <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.44</span><span class="p">),</span>
    <span class="n">ncol</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
    <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_final2</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;PM</span><span class="si">{</span><span class="n">pm</span><span class="si">}</span><span class="s1"> [ug/m3]&#39;</span><span class="p">],</span> <span class="n">df_final2</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;PM</span><span class="si">{</span><span class="n">pm</span><span class="si">}</span><span class="s1"> [ug/m3]&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_final2</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;PM</span><span class="si">{</span><span class="n">pm</span><span class="si">}</span><span class="s1"> [ug/m3]&#39;</span><span class="p">],</span> <span class="n">df_final2</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ubc_pm</span><span class="si">}{</span><span class="n">pm_u</span><span class="si">}</span><span class="s1">_cor&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_final2</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;PM</span><span class="si">{</span><span class="n">pm</span><span class="si">}</span><span class="s1"> [ug/m3]&#39;</span><span class="p">],</span> <span class="n">df_final2</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ubc_pm</span><span class="si">}{</span><span class="n">pm_u</span><span class="si">}</span><span class="s1">_env&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\frac{\mu g}{m^3}$&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\frac{\mu g}{m^3}$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">anchored_text</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">bins</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.6</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_final2</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;PM</span><span class="si">{</span><span class="n">pm</span><span class="si">}</span><span class="s1"> [ug/m3]&#39;</span><span class="p">],</span><span class="n">bins</span><span class="p">,</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_final2</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ubc_pm</span><span class="si">}{</span><span class="n">pm_u</span><span class="si">}</span><span class="s1">_cor&#39;</span><span class="p">],</span><span class="n">bins</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_final2</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ubc_pm</span><span class="si">}{</span><span class="n">pm_u</span><span class="si">}</span><span class="s1">_env&#39;</span><span class="p">],</span><span class="n">bins</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\frac{\mu g}{m^3}$&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;$\\frac{\\mu g}{m^3}$&#39;)
</pre></div>
</div>
<img alt="_images/calibration_46_1.png" src="_images/calibration_46_1.png" />
</div>
</div>
<p>While the MLP moves the PM2.5 concentration values in the correct direction, we recognize this is approach will not work when applied to our field measurements. Our current MLP model is trained from particular conditions with a narrow particle distribution size range. To make this more robust, we need to expose the sensors to a broader range of known particle compositions, sizes, and distributions in the lab.</p>
</section>
</section>


              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="code.html" title="previous page">Code</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Christopher Rodell<br/>
        
            &copy; Copyright 2020, Christopher Rodell.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>